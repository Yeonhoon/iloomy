<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="orders">

	<insert id="saveOrders" parameterType="order">
		<selectKey keyProperty="orderNo" resultType="int" order="BEFORE">
			select order_seq.nextval from dual
		</selectKey>
		insert into orders 
			(order_no, status, delivery_delivery_no, members_members_id)
		values (
			#{orderNo},
			#{orderStatus, typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler},
			#{deliveryDeliveryNo}, #{membersMembersId}
		)
	</insert>
	
	<insert id="saveOrderItem" parameterType="orderitem">
		insert into order_items (order_items_no, order_items_count, order_items_price, orders_order_no, items_items_no)
		values (order_seq.nextval, #{orderItemsCount}, #{orderItemsPrice}, #{orderOrderNo}, #{itemsItemsNo})
		
	</insert>
	
	<select id="selectItemCart" resultType="orderitem">
		select a.order_items_no, a.order_items_count, a.order_items_price, a.orders_order_no, a.items_items_no
		from order_items a join orders b on a.orders_order_no = b.order_no
		where b.status =0
	</select>
</mapper>